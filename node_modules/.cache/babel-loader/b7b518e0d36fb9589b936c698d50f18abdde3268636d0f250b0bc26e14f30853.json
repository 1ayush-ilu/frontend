{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from\"react\";import api from\"../api\";import{jsx as _jsx}from\"react/jsx-runtime\";const AuthCtx=/*#__PURE__*/createContext();export function AuthProvider(_ref){let{children}=_ref;const[user,setUser]=useState(()=>JSON.parse(localStorage.getItem(\"user\")||\"null\"));// ✅ Verify token on mount\nuseEffect(()=>{const checkAuth=async()=>{const token=localStorage.getItem(\"token\");if(!token)return logout();try{const{data}=await api.get(\"/auth/me\");// <-- make sure backend has this route\nsetUser(data.user);localStorage.setItem(\"user\",JSON.stringify(data.user));}catch(_unused){logout();}};checkAuth();},[]);const login=async(email,password)=>{const{data}=await api.post(\"/auth/login\",{email,password});localStorage.setItem(\"token\",data.token);localStorage.setItem(\"user\",JSON.stringify(data.user));setUser(data.user);};const register=async payload=>{const{data}=await api.post(\"/auth/register\",payload);localStorage.setItem(\"token\",data.token);localStorage.setItem(\"user\",JSON.stringify(data.user));setUser(data.user);};const logout=()=>{localStorage.clear();setUser(null);};return/*#__PURE__*/_jsx(AuthCtx.Provider,{value:{user,login,register,logout},children:children});}export const useAuth=()=>useContext(AuthCtx);","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","api","jsx","_jsx","AuthCtx","AuthProvider","_ref","children","user","setUser","JSON","parse","localStorage","getItem","checkAuth","token","logout","data","get","setItem","stringify","_unused","login","email","password","post","register","payload","clear","Provider","value","useAuth"],"sources":["C:/Users/dell/Desktop/final/frontend/src/context/AuthContext.jsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from \"react\";\nimport api from \"../api\";\n\nconst AuthCtx = createContext();\n\nexport function AuthProvider({ children }) {\n  const [user, setUser] = useState(() => JSON.parse(localStorage.getItem(\"user\") || \"null\"));\n\n  // ✅ Verify token on mount\n  useEffect(() => {\n    const checkAuth = async () => {\n      const token = localStorage.getItem(\"token\");\n      if (!token) return logout();\n      try {\n        const { data } = await api.get(\"/auth/me\"); // <-- make sure backend has this route\n        setUser(data.user);\n        localStorage.setItem(\"user\", JSON.stringify(data.user));\n      } catch {\n        logout();\n      }\n    };\n    checkAuth();\n  }, []);\n\n  const login = async (email, password) => {\n    const { data } = await api.post(\"/auth/login\", { email, password });\n    localStorage.setItem(\"token\", data.token);\n    localStorage.setItem(\"user\", JSON.stringify(data.user));\n    setUser(data.user);\n  };\n\n  const register = async (payload) => {\n    const { data } = await api.post(\"/auth/register\", payload);\n    localStorage.setItem(\"token\", data.token);\n    localStorage.setItem(\"user\", JSON.stringify(data.user));\n    setUser(data.user);\n  };\n\n  const logout = () => {\n    localStorage.clear();\n    setUser(null);\n  };\n\n  return (\n    <AuthCtx.Provider value={{ user, login, register, logout }}>\n      {children}\n    </AuthCtx.Provider>\n  );\n}\n\nexport const useAuth = () => useContext(AuthCtx);\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,UAAU,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC7E,MAAO,CAAAC,GAAG,KAAM,QAAQ,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEzB,KAAM,CAAAC,OAAO,cAAGP,aAAa,CAAC,CAAC,CAE/B,MAAO,SAAS,CAAAQ,YAAYA,CAAAC,IAAA,CAAe,IAAd,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGV,QAAQ,CAAC,IAAMW,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,EAAI,MAAM,CAAC,CAAC,CAE1F;AACAb,SAAS,CAAC,IAAM,CACd,KAAM,CAAAc,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5B,KAAM,CAAAC,KAAK,CAAGH,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,GAAI,CAACE,KAAK,CAAE,MAAO,CAAAC,MAAM,CAAC,CAAC,CAC3B,GAAI,CACF,KAAM,CAAEC,IAAK,CAAC,CAAG,KAAM,CAAAhB,GAAG,CAACiB,GAAG,CAAC,UAAU,CAAC,CAAE;AAC5CT,OAAO,CAACQ,IAAI,CAACT,IAAI,CAAC,CAClBI,YAAY,CAACO,OAAO,CAAC,MAAM,CAAET,IAAI,CAACU,SAAS,CAACH,IAAI,CAACT,IAAI,CAAC,CAAC,CACzD,CAAE,MAAAa,OAAA,CAAM,CACNL,MAAM,CAAC,CAAC,CACV,CACF,CAAC,CACDF,SAAS,CAAC,CAAC,CACb,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAQ,KAAK,CAAG,KAAAA,CAAOC,KAAK,CAAEC,QAAQ,GAAK,CACvC,KAAM,CAAEP,IAAK,CAAC,CAAG,KAAM,CAAAhB,GAAG,CAACwB,IAAI,CAAC,aAAa,CAAE,CAAEF,KAAK,CAAEC,QAAS,CAAC,CAAC,CACnEZ,YAAY,CAACO,OAAO,CAAC,OAAO,CAAEF,IAAI,CAACF,KAAK,CAAC,CACzCH,YAAY,CAACO,OAAO,CAAC,MAAM,CAAET,IAAI,CAACU,SAAS,CAACH,IAAI,CAACT,IAAI,CAAC,CAAC,CACvDC,OAAO,CAACQ,IAAI,CAACT,IAAI,CAAC,CACpB,CAAC,CAED,KAAM,CAAAkB,QAAQ,CAAG,KAAO,CAAAC,OAAO,EAAK,CAClC,KAAM,CAAEV,IAAK,CAAC,CAAG,KAAM,CAAAhB,GAAG,CAACwB,IAAI,CAAC,gBAAgB,CAAEE,OAAO,CAAC,CAC1Df,YAAY,CAACO,OAAO,CAAC,OAAO,CAAEF,IAAI,CAACF,KAAK,CAAC,CACzCH,YAAY,CAACO,OAAO,CAAC,MAAM,CAAET,IAAI,CAACU,SAAS,CAACH,IAAI,CAACT,IAAI,CAAC,CAAC,CACvDC,OAAO,CAACQ,IAAI,CAACT,IAAI,CAAC,CACpB,CAAC,CAED,KAAM,CAAAQ,MAAM,CAAGA,CAAA,GAAM,CACnBJ,YAAY,CAACgB,KAAK,CAAC,CAAC,CACpBnB,OAAO,CAAC,IAAI,CAAC,CACf,CAAC,CAED,mBACEN,IAAA,CAACC,OAAO,CAACyB,QAAQ,EAACC,KAAK,CAAE,CAAEtB,IAAI,CAAEc,KAAK,CAAEI,QAAQ,CAAEV,MAAO,CAAE,CAAAT,QAAA,CACxDA,QAAQ,CACO,CAAC,CAEvB,CAEA,MAAO,MAAM,CAAAwB,OAAO,CAAGA,CAAA,GAAMjC,UAAU,CAACM,OAAO,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}