{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useParams,useNavigate}from\"react-router-dom\";import{io}from\"socket.io-client\";import api from\"../api\";import Timer from\"../components/Timer\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const socket=io(process.env.REACT_APP_API.replace(\"/api\",\"\"),{transports:[\"websocket\"]});export default function QuizPage(){const{id}=useParams();const[quiz,setQuiz]=useState(null);const[answers,setAnswers]=useState([]);const[submitted,setSubmitted]=useState(false);const[started,setStarted]=useState(false);// ✅ added\nconst nav=useNavigate();useEffect(()=>{api.get(\"/quiz/\".concat(id)).then(_ref=>{let{data}=_ref;setQuiz(data);setAnswers(new Array(data.questions.length).fill(null));});socket.emit(\"quiz:join\",id);},[id]);const submit=async()=>{try{await api.post(\"/\".concat(id,\"/submit\"),{answers});setSubmitted(true);nav(\"/leaderboard/\".concat(id));}catch(e){var _e$response,_e$response$data;alert((e===null||e===void 0?void 0:(_e$response=e.response)===null||_e$response===void 0?void 0:(_e$response$data=_e$response.data)===null||_e$response$data===void 0?void 0:_e$response$data.msg)||\"Submit failed\");}};if(!quiz){return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:\"Loading...\"})});}// ✅ Start screen\nif(!started){return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card space-y-4 text-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold\",children:quiz.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg\",children:quiz.prompt||\"Get ready to start the quiz!\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:()=>setStarted(true),children:\"Start Quiz\"})]})});}// ✅ Show quiz after Start button clicked\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold\",children:quiz.title}),/*#__PURE__*/_jsx(Timer,{seconds:120,onEnd:()=>!submitted&&submit()})]}),quiz.questions.map((q,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold mb-2\",children:[/*#__PURE__*/_jsxs(\"b\",{children:[\"Q\",idx+1,\".\"]}),\" \",q.question]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid md:grid-cols-2 gap-2\",children:q.options.map((op,i)=>/*#__PURE__*/_jsxs(\"label\",{className:\"cursor-pointer rounded-2xl px-3 py-2 border \".concat(answers[idx]===i?\"border-accent bg-white/5\":\"border-white/10 hover:bg-white/5\"),children:[/*#__PURE__*/_jsx(\"input\",{className:\"mr-2\",type:\"radio\",name:\"q\".concat(idx),checked:answers[idx]===i,onChange:()=>setAnswers(a=>{const b=[...a];b[idx]=i;return b;})}),op]},i))})]},idx)),/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:submit,disabled:submitted,children:\"Submit\"})]})});}","map":{"version":3,"names":["React","useEffect","useState","useParams","useNavigate","io","api","Timer","jsx","_jsx","jsxs","_jsxs","socket","process","env","REACT_APP_API","replace","transports","QuizPage","id","quiz","setQuiz","answers","setAnswers","submitted","setSubmitted","started","setStarted","nav","get","concat","then","_ref","data","Array","questions","length","fill","emit","submit","post","e","_e$response","_e$response$data","alert","response","msg","className","children","title","prompt","onClick","seconds","onEnd","map","q","idx","question","options","op","i","type","name","checked","onChange","a","b","disabled"],"sources":["C:/Users/dell/Desktop/final/frontend/src/pages/QuizPage.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport { io } from \"socket.io-client\";\nimport api from \"../api\";\nimport Timer from \"../components/Timer\";\n\nconst socket = io(process.env.REACT_APP_API.replace(\"/api\",\"\"), { transports: [\"websocket\"] });\n\nexport default function QuizPage() {\n  const { id } = useParams();\n  const [quiz, setQuiz] = useState(null);\n  const [answers, setAnswers] = useState([]);\n  const [submitted, setSubmitted] = useState(false);\n  const [started, setStarted] = useState(false); // ✅ added\n  const nav = useNavigate();\n\n  useEffect(() => {\n    api.get(`/quiz/${id}`).then(({ data }) => {\n      setQuiz(data);\n      setAnswers(new Array(data.questions.length).fill(null));\n    });\n    socket.emit(\"quiz:join\", id);\n  }, [id]);\n\n  const submit = async () => {\n    try {\n      await api.post(`/${id}/submit`, { answers });\n      setSubmitted(true);\n      nav(`/leaderboard/${id}`);\n    } catch (e) {\n      alert(e?.response?.data?.msg || \"Submit failed\");\n    }\n  };\n\n  if (!quiz) {\n    return (\n      <div className=\"container\">\n        <div className=\"card\">Loading...</div>\n      </div>\n    );\n  }\n\n  // ✅ Start screen\n  if (!started) {\n    return (\n      <div className=\"container\">\n        <div className=\"card space-y-4 text-center\">\n          <h2 className=\"text-2xl font-bold\">{quiz.title}</h2>\n          <p className=\"text-lg\">{quiz.prompt || \"Get ready to start the quiz!\"}</p>\n          <button className=\"btn\" onClick={() => setStarted(true)}>Start Quiz</button>\n        </div>\n      </div>\n    );\n  }\n\n  // ✅ Show quiz after Start button clicked\n  return (\n    <div className=\"container\">\n      <div className=\"card space-y-4\">\n        <div className=\"flex items-center justify-between\">\n          <h2 className=\"text-2xl font-bold\">{quiz.title}</h2>\n          <Timer seconds={120} onEnd={() => !submitted && submit()} />\n        </div>\n        {quiz.questions.map((q, idx) => (\n          <div key={idx} className=\"card\">\n            <p className=\"font-semibold mb-2\"><b>Q{idx + 1}.</b> {q.question}</p>\n            <div className=\"grid md:grid-cols-2 gap-2\">\n              {q.options.map((op, i) => (\n                <label\n                  key={i}\n                  className={`cursor-pointer rounded-2xl px-3 py-2 border ${\n                    answers[idx] === i ? \"border-accent bg-white/5\" : \"border-white/10 hover:bg-white/5\"\n                  }`}\n                >\n                  <input\n                    className=\"mr-2\"\n                    type=\"radio\"\n                    name={`q${idx}`}\n                    checked={answers[idx] === i}\n                    onChange={() =>\n                      setAnswers((a) => {\n                        const b = [...a];\n                        b[idx] = i;\n                        return b;\n                      })\n                    }\n                  />\n                  {op}\n                </label>\n              ))}\n            </div>\n          </div>\n        ))}\n        <button className=\"btn\" onClick={submit} disabled={submitted}>Submit</button>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}